2026-01-20 13:54:08,841 INFO    MainThread:1506814 [wandb_setup.py:_flush():76] Current SDK version is 0.15.8
2026-01-20 13:54:08,842 INFO    MainThread:1506814 [wandb_setup.py:_flush():76] Configure stats pid to 1506814
2026-01-20 13:54:08,842 INFO    MainThread:1506814 [wandb_setup.py:_flush():76] Loading settings from /lustre/grp/cmclab/qinxy/.config/wandb/settings
2026-01-20 13:54:08,842 INFO    MainThread:1506814 [wandb_setup.py:_flush():76] Loading settings from /lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/wandb/settings
2026-01-20 13:54:08,842 INFO    MainThread:1506814 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2026-01-20 13:54:08,842 INFO    MainThread:1506814 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2026-01-20 13:54:08,842 INFO    MainThread:1506814 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'sample_antibody_nanobody.py', 'program': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/sample_antibody_nanobody.py'}
2026-01-20 13:54:08,847 INFO    MainThread:1506814 [wandb_init.py:_log_setup():507] Logging user logs to /lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2/wandb/offline-run-20260120_135408-ra63hgcn/logs/debug.log
2026-01-20 13:54:08,851 INFO    MainThread:1506814 [wandb_init.py:_log_setup():508] Logging internal logs to /lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2/wandb/offline-run-20260120_135408-ra63hgcn/logs/debug-internal.log
2026-01-20 13:54:08,852 INFO    MainThread:1506814 [wandb_init.py:init():547] calling init triggers
2026-01-20 13:54:08,852 INFO    MainThread:1506814 [wandb_init.py:init():554] wandb.init called with sweep_config: {}
config: {}
2026-01-20 13:54:08,852 INFO    MainThread:1506814 [wandb_init.py:init():596] starting backend
2026-01-20 13:54:08,852 INFO    MainThread:1506814 [wandb_init.py:init():600] setting up manager
2026-01-20 13:54:08,915 INFO    MainThread:1506814 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2026-01-20 13:54:08,935 INFO    MainThread:1506814 [wandb_init.py:init():606] backend started and connected
2026-01-20 13:54:08,945 INFO    MainThread:1506814 [wandb_init.py:init():697] updated telemetry
2026-01-20 13:54:08,946 INFO    MainThread:1506814 [wandb_init.py:init():730] communicating run to backend with 60.0 second timeout
2026-01-20 13:54:08,952 INFO    MainThread:1506814 [wandb_init.py:init():781] starting run threads in backend
2026-01-20 13:54:16,358 INFO    MainThread:1506814 [wandb_run.py:_console_start():2159] atexit reg
2026-01-20 13:54:16,359 INFO    MainThread:1506814 [wandb_run.py:_redirect():2014] redirect: wrap_raw
2026-01-20 13:54:16,359 INFO    MainThread:1506814 [wandb_run.py:_redirect():2079] Wrapping output streams.
2026-01-20 13:54:16,359 INFO    MainThread:1506814 [wandb_run.py:_redirect():2104] Redirects installed.
2026-01-20 13:54:16,360 INFO    MainThread:1506814 [wandb_init.py:init():822] run started, returning control to user process
2026-01-20 13:54:16,421 INFO    MainThread:1506814 [wandb_run.py:_config_callback():1282] config_cb None None {'data:task': 'binder_motif', 'data:dataset': 'ppi', 'data:loader:num_workers': 4, 'data:loader:prefetch_factor': 10, 'data:sampler:max_batch_size': 16, 'data:sampler:max_num_res_squared': 270000, 'data:sampler:batch_repeats': 2, 'data:sampler:monomer_sample_ratio': 0.25, 'data:sampler:log_dir': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2/..', 'interpolant:t_method': 'uniform', 'interpolant:alpha_t': 3.0, 'interpolant:min_t': 0.01, 'interpolant:separate_t': False, 'interpolant:provide_kappa': False, 'interpolant:hierarchical_t': False, 'interpolant:dynamic_t_method:intervals': [[0, 0.25], [0.25, 0.5], [0.5, 0.75], [0.75, 1.0]], 'interpolant:dynamic_t_method:initial_probs': [0.25, 0.25, 0.25, 0.25], 'interpolant:dynamic_t_method:final_probs': [0.6, 0.2, 0.1, 0.1], 'interpolant:dynamic_t_method:max_epochs': 1000, 'interpolant:piecewise_t_method:intervals': [[0, 0.25], [0.25, 0.5], [0.5, 0.75], [0.75, 1.0]], 'interpolant:piecewise_t_method:probs': [[0.55, 0.25, 0.1, 0.1], [0.65, 0.2, 0.1, 0.05]], 'interpolant:piecewise_t_method:start_epochs': [50, 100], 'interpolant:twisting:use': False, 'interpolant:starting_at_hotspot_center': False, 'interpolant:rots:corrupt': True, 'interpolant:rots:train_schedule': 'linear', 'interpolant:rots:sample_schedule': 'exp', 'interpolant:rots:exp_rate': 10, 'interpolant:trans:corrupt': True, 'interpolant:trans:var_scale': 10, 'interpolant:trans:batch_ot': True, 'interpolant:trans:train_schedule': 'linear', 'interpolant:trans:sample_schedule': 'linear', 'interpolant:trans:sample_temp': 1.0, 'interpolant:trans:vpsde_bmin': 0.1, 'interpolant:trans:vpsde_bmax': 20.0, 'interpolant:trans:potential': None, 'interpolant:trans:potential_t_scaling': False, 'interpolant:trans:rog:weight': 10.0, 'interpolant:trans:rog:cutoff': 5.0, 'interpolant:sampling:num_timesteps': 100, 'interpolant:sampling:do_sde': False, 'interpolant:self_condition': True, 'experiment:debug': False, 'experiment:novo_embedding_layers': False, 'experiment:seed': 123, 'experiment:num_devices': 8, 'experiment:warm_start': None, 'experiment:warm_start_cfg_override': False, 'experiment:training:bb_atom_scale': 0.1, 'experiment:training:trans_scale': 0.1, 'experiment:training:translation_loss_weight': 3.0, 'experiment:training:t_normalize_clip': 0.9, 'experiment:training:rotation_loss_weights': 1.0, 'experiment:training:aux_loss_weight': 1.0, 'experiment:training:aux_loss_use_bb_loss': 1.0, 'experiment:training:aux_loss_use_pair_loss': 1.0, 'experiment:training:aux_loss_use_clash_loss': 0.0, 'experiment:training:aux_loss_use_interchain_clash_loss': 0.0, 'experiment:training:aux_loss_use_center_mse_loss': 0.0, 'experiment:training:aux_loss_use_interface_loss': 1.0, 'experiment:training:ca_clash_tolerance': 1.2, 'experiment:training:interchain_clash_tolerance': 2.0, 'experiment:training:aux_loss_t_pass': 0.1, 'experiment:training:pair_loss_use_hotspot_loss': True, 'experiment:training:trans_loss_clamp': 8, 'experiment:training:auxiliary_loss_clamp': 8, 'experiment:training:use_seq_loss': False, 'experiment:training:seq_loss_weight': 1.0, 'experiment:training:seq_loss_clamp': 5, 'experiment:wandb:name': 'binder_motif_ppi', 'experiment:wandb:project': 'se3-fm', 'experiment:wandb:save_code': True, 'experiment:wandb:mode': 'offline', 'experiment:wandb:save_dir': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2', 'experiment:wandb:dir': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2/..', 'experiment:optimizer:lr': 1e-05, 'experiment:trainer:min_epochs': 1, 'experiment:trainer:max_epochs': 1000, 'experiment:trainer:accelerator': 'gpu', 'experiment:trainer:log_every_n_steps': 1, 'experiment:trainer:deterministic': False, 'experiment:trainer:num_nodes': 1, 'experiment:trainer:check_val_every_n_epoch': 1, 'experiment:trainer:accumulate_grad_batches': 2, 'experiment:trainer:enable_progress_bar': True, 'experiment:checkpointer:dirpath': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2', 'experiment:checkpointer:save_top_k': -1, 'experiment:checkpointer:mode': 'max', 'experiment:pretrain_path': '/lustre/grp/cmclab/huangxk/workspace/ppiflow_antibody/experiments/results/binder_motif_ppi/20251028/12_49_32/ckpt/epoch=70-step=19809.ckpt', 'experiment:dir': 'results/binder_motif_ppi/20251028/21_26_24/ckpt/..', 'experiment:testing_model:ckpt_path': '/lustre/grp/cmclab/share/huangxk/nanobody_1103/epoch=124-step=13000.ckpt', 'experiment:testing_model:save_dir': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2', 'experiment:testing_model:antigen_chain': 'M', 'experiment:testing_model:heavy_chain': 'A', 'experiment:testing_model:light_chain': None, 'experiment:framework_pdb': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/input/7xl0_nanobody_framework.pdb', 'shared:seed': 123, 'shared:max_cache_size': 100000, 'shared:samples_per_eval_length': 5, 'shared:num_eval_lengths': 8, 'shared:max_eval_length': 256, 'shared:min_motif_percent': 0.05, 'shared:max_motif_percent': 0.5, 'ppi_dataset:seed': 123, 'ppi_dataset:train_csv_path': '/lustre/grp/cmclab/share/huangxk/data/Sabdab_Tcr_Nanobody.csv', 'ppi_dataset:val_csv_path': '/lustre/grp/cmclab/share/huangxk/data/Nanobody_metadata_val.csv', 'ppi_dataset:val_csv_path1': 'unused', 'ppi_dataset:define_hotspots': True, 'ppi_dataset:samples_min_hotspots': 3, 'ppi_dataset:min_hotspot_ratio': 0.0, 'ppi_dataset:max_hotspot_ratio': 0.2, 'ppi_dataset:motif_task_freq': 1.0, 'ppi_dataset:binder_motif_task_freq': 1.0, 'ppi_dataset:motif:binder_motif_mode': 'framework', 'ppi_dataset:motif:define_motif': False, 'ppi_dataset:motif:min_motif_percent': 0.5, 'ppi_dataset:motif:max_motif_percent': 0.9, 'ppi_dataset:motif:motif_min_n_seg': 1, 'ppi_dataset:motif:motif_max_n_seg': 4, 'ppi_dataset:motif:motif_datanum_percent': 1.0, 'ppi_dataset:max_cache_size': 100000, 'ppi_dataset:cache_num_res': 0, 'ppi_dataset:add_plddt_mask': False, 'ppi_dataset:max_eval_length': 256, 'ppi_dataset:samples_min_length': 50, 'ppi_dataset:samples_max_length': 100, 'ppi_dataset:samples_per_target': 1, 'ppi_dataset:samples_batch_size': 1, 'ppi_dataset:sample_original_binder_len': False, 'ppi_dataset:sample_pdbname': None, 'ppi_dataset:filter:activate': True, 'ppi_dataset:filter:max_complex_len': 512, 'ppi_dataset:filter:max_complex_len_val': 512, 'ppi_dataset:filter:max_homo_dimer_rate': 0.6, 'ppi_dataset:filter:max_coil_percent': 0.95, 'ppi_dataset:filter:max_binder_len': 384, 'ppi_dataset:filter:min_target_len': 5, 'ppi_dataset:filter:max_binder_target_len_ratio': 100.0, 'ppi_dataset:filter:max_monomer_len': 256, 'ppi_dataset:test_csv_path': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2/input/4dn4_ccl2_input.csv', 'model:node_embed_size': 256, 'model:edge_embed_size': 128, 'model:symmetric': False, 'model:use_gradient_checkpointing': False, 'model:use_deepspeed_evo_attention': False, 'model:node_features:c_s': 256, 'model:node_features:c_pos_emb': 128, 'model:node_features:c_timestep_emb': 128, 'model:node_features:c_aatype_emb': 128, 'model:node_features:max_num_res': 2000, 'model:node_features:timestep_int': 1000, 'model:node_features:embed_chain': True, 'model:node_features:embed_aatype': True, 'model:node_features:n_aatype': 22, 'model:node_features:task': 'binder_motif', 'model:edge_features:single_bias_transition_n': 2, 'model:edge_features:c_s': 256, 'model:edge_features:c_p': 128, 'model:edge_features:relpos_k': 64, 'model:edge_features:feat_dim': 64, 'model:edge_features:rel_pos_feat_dim': 64, 'model:edge_features:num_bins': 22, 'model:edge_features:pairwise_direction': True, 'model:edge_features:self_condition': True, 'model:edge_features:embed_chain': True, 'model:edge_features:embed_diffuse_mask': True, 'model:edge_features:embed_hotspot_mask': True, 'model:edge_features:embed_aatype': True, 'model:edge_features:task': 'binder_motif', 'model:ipa:c_s': 256, 'model:ipa:c_z': 128, 'model:ipa:c_hidden': 128, 'model:ipa:no_heads': 8, 'model:ipa:no_qk_points': 8, 'model:ipa:no_v_points': 12, 'model:ipa:seq_tfmr_num_heads': 4, 'model:ipa:seq_tfmr_num_layers': 2, 'model:ipa:num_blocks': 6, 'model:seq_decoder:use': False, 'model:seq_decoder:c_s': 256, 'model:seq_decoder:feat_dim': 128, 'model:pairformer:use': True, 'model:pairformer:c_s': 256, 'model:pairformer:c_z': 128, 'model:pairformer:no_heads': 8, 'model:pairformer:num_blocks': 4, 'model:pairformer:c_hidden_pair_att': 16, 'model:pairformer:no_heads_pair': 4, 'model:task': 'binder_motif'}
2026-01-20 13:54:17,490 INFO    MainThread:1506814 [wandb_run.py:_config_callback():1282] config_cb None None {'cfg': "{'data': {'task': 'binder_motif', 'dataset': 'ppi', 'loader': {'num_workers': 4, 'prefetch_factor': 10}, 'sampler': {'max_batch_size': 16, 'max_num_res_squared': 270000, 'batch_repeats': 2, 'monomer_sample_ratio': 0.25, 'log_dir': '${experiment.checkpointer.dirpath}/..'}}, 'interpolant': {'t_method': 'uniform', 'alpha_t': 3.0, 'min_t': 0.01, 'separate_t': False, 'provide_kappa': False, 'hierarchical_t': False, 'dynamic_t_method': {'intervals': [[0, 0.25], [0.25, 0.5], [0.5, 0.75], [0.75, 1.0]], 'initial_probs': [0.25, 0.25, 0.25, 0.25], 'final_probs': [0.6, 0.2, 0.1, 0.1], 'max_epochs': '${experiment.trainer.max_epochs}'}, 'piecewise_t_method': {'intervals': [[0, 0.25], [0.25, 0.5], [0.5, 0.75], [0.75, 1.0]], 'probs': [[0.55, 0.25, 0.1, 0.1], [0.65, 0.2, 0.1, 0.05]], 'start_epochs': [50, 100]}, 'twisting': {'use': False}, 'starting_at_hotspot_center': False, 'rots': {'corrupt': True, 'train_schedule': 'linear', 'sample_schedule': 'exp', 'exp_rate': 10}, 'trans': {'corrupt': True, 'var_scale': 10, 'batch_ot': True, 'train_schedule': 'linear', 'sample_schedule': 'linear', 'sample_temp': 1.0, 'vpsde_bmin': 0.1, 'vpsde_bmax': 20.0, 'potential': None, 'potential_t_scaling': False, 'rog': {'weight': 10.0, 'cutoff': 5.0}}, 'sampling': {'num_timesteps': 100, 'do_sde': False}, 'self_condition': '${model.edge_features.self_condition}'}, 'experiment': {'debug': False, 'novo_embedding_layers': False, 'seed': 123, 'num_devices': 8, 'warm_start': None, 'warm_start_cfg_override': False, 'training': {'bb_atom_scale': 0.1, 'trans_scale': 0.1, 'translation_loss_weight': 3.0, 't_normalize_clip': 0.9, 'rotation_loss_weights': 1.0, 'aux_loss_weight': 1.0, 'aux_loss_use_bb_loss': 1.0, 'aux_loss_use_pair_loss': 1.0, 'aux_loss_use_clash_loss': 0.0, 'aux_loss_use_interchain_clash_loss': 0.0, 'aux_loss_use_center_mse_loss': 0.0, 'aux_loss_use_interface_loss': 1.0, 'ca_clash_tolerance': 1.2, 'interchain_clash_tolerance': 2.0, 'aux_loss_t_pass': 0.1, 'pair_loss_use_hotspot_loss': True, 'trans_loss_clamp': 8, 'auxiliary_loss_clamp': 8, 'use_seq_loss': False, 'seq_loss_weight': 1.0, 'seq_loss_clamp': 5}, 'wandb': {'name': '${data.task}_${data.dataset}', 'project': 'se3-fm', 'save_code': True, 'mode': 'offline', 'save_dir': 'results/binder_motif_ppi/20251028/21_26_24/ckpt/..', 'dir': '${experiment.checkpointer.dirpath}/..'}, 'optimizer': {'lr': 1e-05}, 'trainer': {'min_epochs': 1, 'max_epochs': 1000, 'accelerator': 'gpu', 'log_every_n_steps': 1, 'deterministic': False, 'num_nodes': 1, 'check_val_every_n_epoch': 1, 'accumulate_grad_batches': 2, 'enable_progress_bar': True}, 'checkpointer': {'dirpath': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2', 'save_top_k': -1, 'mode': 'max'}, 'pretrain_path': '/lustre/grp/cmclab/huangxk/workspace/ppiflow_antibody/experiments/results/binder_motif_ppi/20251028/12_49_32/ckpt/epoch=70-step=19809.ckpt', 'dir': 'results/binder_motif_ppi/20251028/21_26_24/ckpt/..', 'testing_model': {'ckpt_path': '/lustre/grp/cmclab/share/huangxk/nanobody_1103/epoch=124-step=13000.ckpt', 'save_dir': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2', 'antigen_chain': 'M', 'heavy_chain': 'A', 'light_chain': None}, 'framework_pdb': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/input/7xl0_nanobody_framework.pdb'}, 'shared': {'seed': 123, 'max_cache_size': 100000, 'samples_per_eval_length': 5, 'num_eval_lengths': 8, 'max_eval_length': 256, 'min_motif_percent': 0.05, 'max_motif_percent': 0.5}, 'ppi_dataset': {'seed': '${shared.seed}', 'train_csv_path': '/lustre/grp/cmclab/share/huangxk/data/Sabdab_Tcr_Nanobody.csv', 'val_csv_path': '/lustre/grp/cmclab/share/huangxk/data/Nanobody_metadata_val.csv', 'val_csv_path1': 'unused', 'define_hotspots': True, 'samples_min_hotspots': 3, 'min_hotspot_ratio': 0.0, 'max_hotspot_ratio': 0.2, 'motif_task_freq': 1.0, 'binder_motif_task_freq': 1.0, 'motif': {'binder_motif_mode': 'framework', 'define_motif': False, 'min_motif_percent': 0.5, 'max_motif_percent': 0.9, 'motif_min_n_seg': 1, 'motif_max_n_seg': 4, 'motif_datanum_percent': 1.0}, 'max_cache_size': '${shared.max_cache_size}', 'cache_num_res': 0, 'add_plddt_mask': False, 'max_eval_length': '${shared.max_eval_length}', 'samples_min_length': 50, 'samples_max_length': 100, 'samples_per_target': 1, 'samples_batch_size': 1, 'sample_original_binder_len': False, 'sample_pdbname': None, 'filter': {'activate': True, 'max_complex_len': 512, 'max_complex_len_val': 512, 'max_homo_dimer_rate': 0.6, 'max_coil_percent': 0.95, 'max_binder_len': 384, 'min_target_len': 5, 'max_binder_target_len_ratio': 100.0, 'max_monomer_len': 256}, 'test_csv_path': '/lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2/input/4dn4_ccl2_input.csv'}, 'model': {'node_embed_size': 256, 'edge_embed_size': 128, 'symmetric': False, 'use_gradient_checkpointing': False, 'use_deepspeed_evo_attention': False, 'node_features': {'c_s': '${model.node_embed_size}', 'c_pos_emb': 128, 'c_timestep_emb': 128, 'c_aatype_emb': 128, 'max_num_res': 2000, 'timestep_int': 1000, 'embed_chain': True, 'embed_aatype': True, 'n_aatype': 22, 'task': 'binder_motif'}, 'edge_features': {'single_bias_transition_n': 2, 'c_s': '${model.node_embed_size}', 'c_p': '${model.edge_embed_size}', 'relpos_k': 64, 'feat_dim': 64, 'rel_pos_feat_dim': 64, 'num_bins': 22, 'pairwise_direction': True, 'self_condition': True, 'embed_chain': True, 'embed_diffuse_mask': True, 'embed_hotspot_mask': True, 'embed_aatype': True, 'task': 'binder_motif'}, 'ipa': {'c_s': '${model.node_embed_size}', 'c_z': '${model.edge_embed_size}', 'c_hidden': 128, 'no_heads': 8, 'no_qk_points': 8, 'no_v_points': 12, 'seq_tfmr_num_heads': 4, 'seq_tfmr_num_layers': 2, 'num_blocks': 6}, 'seq_decoder': {'use': False, 'c_s': '${model.node_embed_size}', 'feat_dim': 128}, 'pairformer': {'use': True, 'c_s': '${model.node_embed_size}', 'c_z': '${model.edge_embed_size}', 'no_heads': 8, 'num_blocks': 4, 'c_hidden_pair_att': 16, 'no_heads_pair': 4}, 'task': 'binder_motif'}}"}
2026-01-20 13:54:54,556 WARNING MsgRouterThr:1506814 [router.py:message_loop():77] message_loop has been closed
