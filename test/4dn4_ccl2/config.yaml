data:
  task: binder_motif
  dataset: ppi
  loader:
    num_workers: 4
    prefetch_factor: 10
  sampler:
    max_batch_size: 16
    max_num_res_squared: 270000
    batch_repeats: 2
    monomer_sample_ratio: 0.25
    log_dir: ${experiment.checkpointer.dirpath}/..
interpolant:
  t_method: uniform
  alpha_t: 3.0
  min_t: 0.01
  separate_t: false
  provide_kappa: false
  hierarchical_t: false
  dynamic_t_method:
    intervals:
    - - 0
      - 0.25
    - - 0.25
      - 0.5
    - - 0.5
      - 0.75
    - - 0.75
      - 1.0
    initial_probs:
    - 0.25
    - 0.25
    - 0.25
    - 0.25
    final_probs:
    - 0.6
    - 0.2
    - 0.1
    - 0.1
    max_epochs: ${experiment.trainer.max_epochs}
  piecewise_t_method:
    intervals:
    - - 0
      - 0.25
    - - 0.25
      - 0.5
    - - 0.5
      - 0.75
    - - 0.75
      - 1.0
    probs:
    - - 0.55
      - 0.25
      - 0.1
      - 0.1
    - - 0.65
      - 0.2
      - 0.1
      - 0.05
    start_epochs:
    - 50
    - 100
  twisting:
    use: false
  starting_at_hotspot_center: false
  rots:
    corrupt: true
    train_schedule: linear
    sample_schedule: exp
    exp_rate: 10
  trans:
    corrupt: true
    var_scale: 10
    batch_ot: true
    train_schedule: linear
    sample_schedule: linear
    sample_temp: 1.0
    vpsde_bmin: 0.1
    vpsde_bmax: 20.0
    potential: null
    potential_t_scaling: false
    rog:
      weight: 10.0
      cutoff: 5.0
  sampling:
    num_timesteps: 100
    do_sde: false
  self_condition: ${model.edge_features.self_condition}
experiment:
  debug: false
  novo_embedding_layers: false
  seed: 123
  num_devices: 8
  warm_start: null
  warm_start_cfg_override: false
  training:
    bb_atom_scale: 0.1
    trans_scale: 0.1
    translation_loss_weight: 3.0
    t_normalize_clip: 0.9
    rotation_loss_weights: 1.0
    aux_loss_weight: 1.0
    aux_loss_use_bb_loss: 1.0
    aux_loss_use_pair_loss: 1.0
    aux_loss_use_clash_loss: 0.0
    aux_loss_use_interchain_clash_loss: 0.0
    aux_loss_use_center_mse_loss: 0.0
    aux_loss_use_interface_loss: 1.0
    ca_clash_tolerance: 1.2
    interchain_clash_tolerance: 2.0
    aux_loss_t_pass: 0.1
    pair_loss_use_hotspot_loss: true
    trans_loss_clamp: 8
    auxiliary_loss_clamp: 8
    use_seq_loss: false
    seq_loss_weight: 1.0
    seq_loss_clamp: 5
  wandb:
    name: ${data.task}_${data.dataset}
    project: se3-fm
    save_code: true
    mode: offline
    save_dir: /lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2
    dir: ${experiment.checkpointer.dirpath}/..
  optimizer:
    lr: 1.0e-05
  trainer:
    min_epochs: 1
    max_epochs: 1000
    accelerator: gpu
    log_every_n_steps: 1
    deterministic: false
    num_nodes: 1
    check_val_every_n_epoch: 1
    accumulate_grad_batches: 2
    enable_progress_bar: true
  checkpointer:
    dirpath: /lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2
    save_top_k: -1
    mode: max
  pretrain_path: /lustre/grp/cmclab/huangxk/workspace/ppiflow_antibody/experiments/results/binder_motif_ppi/20251028/12_49_32/ckpt/epoch=70-step=19809.ckpt
  dir: results/binder_motif_ppi/20251028/21_26_24/ckpt/..
  testing_model:
    ckpt_path: /lustre/grp/cmclab/share/huangxk/nanobody_1103/epoch=124-step=13000.ckpt
    save_dir: /lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2
    antigen_chain: M
    heavy_chain: A
    light_chain: null
  framework_pdb: /lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/input/7xl0_nanobody_framework.pdb
shared:
  seed: 123
  max_cache_size: 100000
  samples_per_eval_length: 5
  num_eval_lengths: 8
  max_eval_length: 256
  min_motif_percent: 0.05
  max_motif_percent: 0.5
ppi_dataset:
  seed: ${shared.seed}
  train_csv_path: /lustre/grp/cmclab/share/huangxk/data/Sabdab_Tcr_Nanobody.csv
  val_csv_path: /lustre/grp/cmclab/share/huangxk/data/Nanobody_metadata_val.csv
  val_csv_path1: unused
  define_hotspots: true
  samples_min_hotspots: 3
  min_hotspot_ratio: 0.0
  max_hotspot_ratio: 0.2
  motif_task_freq: 1.0
  binder_motif_task_freq: 1.0
  motif:
    binder_motif_mode: framework
    define_motif: false
    min_motif_percent: 0.5
    max_motif_percent: 0.9
    motif_min_n_seg: 1
    motif_max_n_seg: 4
    motif_datanum_percent: 1.0
  max_cache_size: ${shared.max_cache_size}
  cache_num_res: 0
  add_plddt_mask: false
  max_eval_length: ${shared.max_eval_length}
  samples_min_length: 50
  samples_max_length: 100
  samples_per_target: 1
  samples_batch_size: 1
  sample_original_binder_len: false
  sample_pdbname: null
  filter:
    activate: true
    max_complex_len: 512
    max_complex_len_val: 512
    max_homo_dimer_rate: 0.6
    max_coil_percent: 0.95
    max_binder_len: 384
    min_target_len: 5
    max_binder_target_len_ratio: 100.0
    max_monomer_len: 256
  test_csv_path: /lustre/grp/cmclab/qinxy/antibody_ppiflow/demo/test/4dn4_ccl2/input/4dn4_ccl2_input.csv
model:
  node_embed_size: 256
  edge_embed_size: 128
  symmetric: false
  use_gradient_checkpointing: false
  use_deepspeed_evo_attention: false
  node_features:
    c_s: ${model.node_embed_size}
    c_pos_emb: 128
    c_timestep_emb: 128
    c_aatype_emb: 128
    max_num_res: 2000
    timestep_int: 1000
    embed_chain: true
    embed_aatype: true
    n_aatype: 22
    task: binder_motif
  edge_features:
    single_bias_transition_n: 2
    c_s: ${model.node_embed_size}
    c_p: ${model.edge_embed_size}
    relpos_k: 64
    feat_dim: 64
    rel_pos_feat_dim: 64
    num_bins: 22
    pairwise_direction: true
    self_condition: true
    embed_chain: true
    embed_diffuse_mask: true
    embed_hotspot_mask: true
    embed_aatype: true
    task: binder_motif
  ipa:
    c_s: ${model.node_embed_size}
    c_z: ${model.edge_embed_size}
    c_hidden: 128
    no_heads: 8
    no_qk_points: 8
    no_v_points: 12
    seq_tfmr_num_heads: 4
    seq_tfmr_num_layers: 2
    num_blocks: 6
  seq_decoder:
    use: false
    c_s: ${model.node_embed_size}
    feat_dim: 128
  pairformer:
    use: true
    c_s: ${model.node_embed_size}
    c_z: ${model.edge_embed_size}
    no_heads: 8
    num_blocks: 4
    c_hidden_pair_att: 16
    no_heads_pair: 4
  task: binder_motif
